<html>
<head>
<title>Chat Room</title>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.8/socket.io.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
</head>
<body>
<script type="text/javascript">
$(document).ready(function() {
	var socket = io.connect('http://127.0.0.1:5000');
	socket.on('connect', function() {
		var connecmsg="A New User";
		var len= connecmsg.length;
		var d= 2753;
		var e= 17;
		var n= d*e;
		var temp= [];
		var tempstr= [];
		var k=-1;
		for(var i=0; i<len; i++)
		{
			temp[i]= connecmsg[i]-97;
			temp[i]= Math.pow(temp[i], e);
			temp[i]%= n;
			tempstr[++k]= temp[i].toString();
			tempstr[++k]="|"; 
		}
		var finals= tempstr.toString();
		socket.send(finals);
	});
	socket.on('message', function(msg) {
		var k=0, i=0;
		var d= 2753, e=17;
		var n= d*e;
		var len= msg.length();
		var temp= [];
		while(k<len)
		{	var s="";
			while(msg[k]!="|")
				s+= msg[k++];
			temp[i++]= parseFloat(s);
			k++;
		}
		for(var i=0;i<temp.length;i++)
		{
			temp[i]= Math.pow(temp[i],d);
			temp[i]%= n;
			temp[i]+= 97;
		}
		var msgrcv= temp.toString(temp);
		$("#messages").append('<li>'+msgrcv+'</li>');
		console.log('Received message');
	});
	$('#sendbutton').on('click', function() {
		var mymsg= $('#myMessage').val();
		var len= mymsg.length;
		var d= 2753;
		var e= 17;
		var n= d*e;
		var temp= [];
		var tempstr= [];
		var k=-1;
		for(var i=0; i<len; i++)
		{
			temp[i]= mymsg[i]-97;
			temp[i]= Math.pow(temp[i], e);
			temp[i]%= n;
			tempstr[++k]= temp[i].toString();
			tempstr[++k]="|"; 
		}
		var finals= tempstr.toString();
		socket.send(finals);
		$('#myMessage').val('');
	});
});
</script>
<ul id="messages"></ul>
<input type="text" id="myMessage">
<button id="sendbutton">Send</button>
</body>
</html>
